{% extends "base.html" %}
{% block title %}–ì–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-12">
            <div class="card shadow-lg border-0 rounded-4">
                <div class="card-body p-5">

                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞ –∫–Ω–æ–ø–∫–∞ -->
                    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
                        <h2 class="fw-bold mb-0">üó≥Ô∏è –î–æ—Å—Ç—É–ø–Ω—ñ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è</h2>
                        <a href="{% url 'vote_create' %}" class="btn btn-outline-success rounded-pill">
                            ‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è
                        </a>
                    </div>
                    <div class="mb-4">
                        <div class="btn-group" role="group">
                            <a href="{% url 'vote_list' %}" class="btn btn-outline-secondary {% if not current_filter %}active{% endif %}">–£—Å—ñ</a>
                            <a href="?filter=active" class="btn btn-outline-success {% if current_filter == 'active' %}active{% endif %}">–ê–∫—Ç–∏–≤–Ω—ñ</a>
                            <a href="?filter=voted" class="btn btn-outline-primary {% if current_filter == 'voted' %}active{% endif %}">–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–Ω—ñ</a>
                            <a href="?filter=finished" class="btn btn-outline-dark {% if current_filter == 'finished' %}active{% endif %}">–ó–∞–≤–µ—Ä—à–µ–Ω—ñ</a>
                        </div>
                    </div>


                    {% if votes %}
                        <div class="row g-4">
                            {% for vote in votes %}
                                <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                                    <div class="border rounded-4 shadow-sm h-100 p-3 d-flex flex-column justify-content-between">

                                        <div>
                                            <h5 class="mb-2">{{ vote.title }}</h5>

                                            <small class="text-muted">
                                                üìÖ {{ vote.start_date|date:"SHORT_DATETIME_FORMAT" }}
                                                ‚Äî {{ vote.end_date|date:"SHORT_DATETIME_FORMAT" }}
                                            </small><br>

                                            <small class="text-muted d-block mt-1">
                                                üë§ –ê–≤—Ç–æ—Ä: {{ vote.creator.get_full_name }}
                                                {% if request.user == vote.creator %}
                                                    <span class="badge bg-secondary">–≤–∏</span>
                                                {% endif %}
                                            </small>

                                            <div class="mt-2">
                                                <span class="badge 
                                                    {% if vote.get_status_display == '–ê–∫—Ç–∏–≤–Ω–µ' %}bg-success
                                                    {% elif vote.get_status_display == '–û—á—ñ–∫—É—î—Ç—å—Å—è –ø–æ—á–∞—Ç–æ–∫' %}bg-secondary
                                                    {% else %}bg-danger{% endif %}">
                                                    {{ vote.get_status_display }}
                                                </span>

                                                {% if vote.id in voted_ids %}
                                                    <span class="badge bg-primary">–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–Ω–æ</span>
                                                {% else %}
                                                    <span class="badge bg-warning text-dark">–ù–µ –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–Ω–æ</span>
                                                {% endif %}
                                            </div>
                                        </div>

                                        <div class="text-end mt-3">
                                            <a href="{% url 'vote_detail' vote.pk %}" class="btn btn-outline-primary btn-sm rounded-pill w-100">
                                                üîç –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                                            </a>
                                        </div>

                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted text-center mt-4">–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –≥–æ–ª–æ—Å—É–≤–∞–Ω—å.</p>
                    {% endif %}

                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
